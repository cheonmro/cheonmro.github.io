<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Redux-Saga를 이용한 API 통신 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="ReactRedux-Saga" />
  
  
  
  
  <meta name="description" content="newsapi.org에 있는 데이터를 가져오기 위해서는, newsapi.org에서 제공하는 API를 이용해야 한다. 이때, 비동기 통신(newsapi.org 서버와의 통신)을 Redux-Saga를 이용해 데이터를 가져와보자.  순서  ‘create-react-app’으로 프로젝트 생성 프로젝트 앱의 index.js에서 Redux와 연동 store.js에서">
<meta name="keywords" content="React,Redux-Saga">
<meta property="og:type" content="article">
<meta property="og:title" content="Redux-Saga를 이용한 API 통신">
<meta property="og:url" content="https://cheonmro.github.io/2019/04/23/fetch-api-using-redux-saga/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="newsapi.org에 있는 데이터를 가져오기 위해서는, newsapi.org에서 제공하는 API를 이용해야 한다. 이때, 비동기 통신(newsapi.org 서버와의 통신)을 Redux-Saga를 이용해 데이터를 가져와보자.  순서  ‘create-react-app’으로 프로젝트 생성 프로젝트 앱의 index.js에서 Redux와 연동 store.js에서">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-04-23T14:44:19.045Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Redux-Saga를 이용한 API 통신">
<meta name="twitter:description" content="newsapi.org에 있는 데이터를 가져오기 위해서는, newsapi.org에서 제공하는 API를 이용해야 한다. 이때, 비동기 통신(newsapi.org 서버와의 통신)을 Redux-Saga를 이용해 데이터를 가져와보자.  순서  ‘create-react-app’으로 프로젝트 생성 프로젝트 앱의 index.js에서 Redux와 연동 store.js에서">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/fashion.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >

</head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  


<header id="allheader" class="site-header" role="banner"
   >
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" rel="home" >
                <img style="margin-bottom: 10px;"  width="124px" height="124px" alt="Hike News" src="https://hexo.io/logo.svg">
              </a>
            
          </h1>

          

          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows"  style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">Categories</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">me &amp; projects</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">

      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-fetch-api-using-redux-saga" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      Redux-Saga를 이용한 API 통신
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/23/fetch-api-using-redux-saga/" class="article-date">
	  <time datetime="2019-04-23T14:44:19.000Z" itemprop="datePublished">April 23, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/React/">React</a>

      
	<!-- <span id="busuanzi_container_page_pv">
	  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
	</span> -->

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://newsapi.org/" target="_blank" rel="noopener">newsapi.org</a>에 있는 데이터를 가져오기 위해서는, newsapi.org에서 제공하는 API를 이용해야 한다. 이때, 비동기 통신(newsapi.org 서버와의 통신)을 Redux-Saga를 이용해 데이터를 가져와보자.</p>
<p><br></p>
<h1 id="순서"><a href="#순서" class="headerlink" title="순서"></a>순서</h1><hr>
<ol start="0">
<li>‘create-react-app’으로 프로젝트 생성</li>
<li>프로젝트 앱의 index.js에서 Redux와 연동</li>
<li>store.js에서 Redux의 store를 세팅</li>
<li>Redux와 연결할 Container 컴포넌트와 화면에 보여줄 각 컴포넌트 생성</li>
<li>통신할 API와 관련된 코드 작성</li>
<li>action 및 action types 등록</li>
<li>Container 컴포넌트에서 액션을 dispatch</li>
<li>액션을 받아 비동기 통신 처리를 할 saga 작성</li>
<li>saga 이후, state를 변경할 reducer 작성</li>
</ol>
<p><br></p>
<h2 id="1-프로젝트-앱의-index-js에서-Redux와-연동"><a href="#1-프로젝트-앱의-index-js에서-Redux와-연동" class="headerlink" title="1. 프로젝트 앱의 index.js에서 Redux와 연동"></a>1. 프로젝트 앱의 index.js에서 Redux와 연동</h2><p>index.js</p>
<p>‘create-react-app’ 한 이후, 처음 상태<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// index.js</span><br><span class="line"></span><br><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import &apos;./index.css&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line">import * as serviceWorker from &apos;./serviceWorker&apos;;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(&lt;App /&gt;, document.getElementById(&apos;root&apos;));</span><br><span class="line"></span><br><span class="line">// If you want your app to work offline and load faster, you can change</span><br><span class="line">// unregister() to register() below. Note this comes with some pitfalls.</span><br><span class="line">// Learn more about service workers: https://bit.ly/CRA-PWA</span><br><span class="line">serviceWorker.unregister();</span><br></pre></td></tr></table></figure></p>
<p><br><br>1-1. Redux 설치<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react-redux</span><br></pre></td></tr></table></figure></p>
<p><br><br>1-2. Redux-saga 설치<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save redux-saga</span><br></pre></td></tr></table></figure></p>
<p><br><br>1-3. Redux 세팅 및 Redux-saga 적용</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// index.js</span><br><span class="line"></span><br><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import &#123; render &#125; from &apos;react-dom&apos;;</span><br><span class="line">import &#123; Provider &#125; from &apos;react-redux&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line">import &#123; store &#125; from &apos;./redux/store&apos; // redux 폴더의 store.js 파일에서 store 관련 코드 작성</span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  // Provier와 store 적용</span><br><span class="line">   &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">     &lt;App /&gt;</span><br><span class="line">   &lt;/Provider&gt;,</span><br><span class="line">document.getElementById(&apos;root&apos;),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="2-store-js에서-Redux의-store를-세팅"><a href="#2-store-js에서-Redux의-store를-세팅" class="headerlink" title="2. store.js에서 Redux의 store를 세팅"></a>2. store.js에서 Redux의 store를 세팅</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// store.js</span><br><span class="line"></span><br><span class="line">import &#123; createStore, compose, applyMiddleware &#125; from &apos;redux&apos;;</span><br><span class="line">import rootReducer from &apos;./reducer&apos;; // reducer.js 파일안에 rootReducer 생성</span><br><span class="line">import createSagaMiddleware from &apos;redux-saga&apos;;</span><br><span class="line">import rootSaga from &apos;../sagas&apos;; // sagas 폴더와 그 안에 index.js 파일 생성</span><br><span class="line"></span><br><span class="line">// saga 미들웨어 생성</span><br><span class="line">const sagaMiddleware = createSagaMiddleware();</span><br><span class="line">const enhancer = compose(</span><br><span class="line">  applyMiddleware(sagaMiddleware)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// store 만들고, reducer와 미들웨어 적용</span><br><span class="line">export const store = createStore(rootReducer, enhancer)</span><br><span class="line">sagaMiddleware.run(rootSaga)</span><br></pre></td></tr></table></figure>
<p>이렇게 하여, Redux store 세팅이 완료되었다.</p>
<p><br></p>
<h2 id="3-Redux와-연결할-Container-컴포넌트와-화면에-보여줄-각-컴포넌트-생성"><a href="#3-Redux와-연결할-Container-컴포넌트와-화면에-보여줄-각-컴포넌트-생성" class="headerlink" title="3. Redux와 연결할 Container 컴포넌트와 화면에 보여줄 각 컴포넌트 생성"></a>3. Redux와 연결할 Container 컴포넌트와 화면에 보여줄 각 컴포넌트 생성</h2><ol>
<li>Contianer 컴포넌트 생성<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">// ContainerRedux.js</span><br><span class="line"></span><br><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line">import &#123; connect &#125; from &quot;react-redux&quot;;</span><br><span class="line">import Button from &apos;./components/Button&apos;</span><br><span class="line">import Loading from &apos;./components/Loading&apos;</span><br><span class="line">import News from &apos;./components/News&apos;</span><br><span class="line"></span><br><span class="line">class ContainerRedux extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;&quot;&gt;</span><br><span class="line">        &lt;Button</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;Loading</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;News</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(ContainerRedux);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><br></p>
<ol start="2">
<li>각 컴포넌트 생성</li>
</ol>
<p>Button.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// Button.js</span><br><span class="line"></span><br><span class="line">import React from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">const Button = (&#123;onClickGetNews&#125;) =&gt; &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button onClick=&#123;onClickGetNews&#125;&gt;get news&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Button;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p>Loading.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// Loading.js</span><br><span class="line"></span><br><span class="line">import React from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">const Loading = (&#123; loading &#125;) =&gt; &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;</span><br><span class="line">        loading ?</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;h1&gt;LOADING ...&lt;/h1&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        :</span><br><span class="line">        null</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Loading;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<p>News.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// News.js</span><br><span class="line"></span><br><span class="line">import React from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">const News = (&#123; articles &#125;) =&gt; &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;</span><br><span class="line">      articles ?</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &#123;</span><br><span class="line">            articles.map((article, key) =&gt; &#123;</span><br><span class="line">              return &lt;div key=&#123;key&#125;&gt;</span><br><span class="line">                &lt;span&gt;&#123;article.title&#125;&lt;/span&gt;</span><br><span class="line">                &lt;img src=&#123;article.urlToImage&#125; alt=&quot;&quot;/&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      :</span><br><span class="line">      null</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default News;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="4-통신할-API와-관련된-코드-작성"><a href="#4-통신할-API와-관련된-코드-작성" class="headerlink" title="4. 통신할 API와 관련된 코드 작성"></a>4. 통신할 API와 관련된 코드 작성</h2><p>4-1. axios 설치<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure></p>
<p><br><br>4-2. api 코드 작성<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// index.js in &apos;api&apos; folder</span><br><span class="line"></span><br><span class="line">import axios from &apos;axios&apos;;</span><br><span class="line"></span><br><span class="line">export function getNews() &#123;</span><br><span class="line">  return axios.get(&apos;https://newsapi.org/v1/articles?source=cnn&amp;apiKey=APIKEY&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>APIKEY는 <a href="https://newsapi.org/" target="_blank" rel="noopener">News API</a>에서 API KEY를 요청하여 받아야 한다.</p>
<p><br></p>
<h2 id="5-action-및-action-types-등록"><a href="#5-action-및-action-types-등록" class="headerlink" title="5. action 및 action types 등록"></a>5. action 및 action types 등록</h2><p>5-1. action creator 생성<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// action.js</span><br><span class="line"></span><br><span class="line">import * as types from &apos;./actionType&apos;;</span><br><span class="line"></span><br><span class="line">export const getNews = () =&gt; (&#123;</span><br><span class="line">  type: types.GET_NEWS_REQUEST,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><br><br>5-2. action type 생성<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// actionType.js</span><br><span class="line"></span><br><span class="line">export const GET_NEWS_REQUEST = &quot;GET_NEWS_REQUEST&quot;;</span><br><span class="line">export const GET_NEWS_SUCCESS = &quot;GET_NEWS_SUCCESS&quot;;</span><br><span class="line">export const GET_NEWS_FAILURE = &quot;GET_NEWS_FAILURE&quot;;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="6-Container-컴포넌트에서-액션을-dispatch-state-및-dispatch-코드-작성"><a href="#6-Container-컴포넌트에서-액션을-dispatch-state-및-dispatch-코드-작성" class="headerlink" title="6. Container 컴포넌트에서 액션을 dispatch(state 및 dispatch 코드 작성)"></a>6. Container 컴포넌트에서 액션을 dispatch(state 및 dispatch 코드 작성)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">// ContainerRedux.js</span><br><span class="line"></span><br><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line">import &#123; connect &#125; from &quot;react-redux&quot;;</span><br><span class="line">import Button from &apos;./components/Button&apos;</span><br><span class="line">import Loading from &apos;./components/Loading&apos;</span><br><span class="line">import News from &apos;./components/News&apos;</span><br><span class="line">import &#123; getNews &#125; from &apos;./redux&apos;</span><br><span class="line"></span><br><span class="line">class ContainerRedux extends Component &#123;</span><br><span class="line">  onClickGetNews = () =&gt; &#123;</span><br><span class="line">    this.props.getNews();</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; loading, articles &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;&quot;&gt;</span><br><span class="line">        &lt;Button</span><br><span class="line">          onClickGetNews=&#123;this.onClickGetNews&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;Loading</span><br><span class="line">          loading=&#123;loading&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;News</span><br><span class="line">          articles=&#123;articles&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    articles: state.getNews.articles,</span><br><span class="line">    loading: state.getNews.loading</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    getNews: () =&gt; dispatch(getNews())</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(ContainerRedux);</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="7-액션을-받아-비동기-통신-처리를-할-saga-작성"><a href="#7-액션을-받아-비동기-통신-처리를-할-saga-작성" class="headerlink" title="7. 액션을 받아 비동기 통신 처리를 할 saga 작성"></a>7. 액션을 받아 비동기 통신 처리를 할 saga 작성</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">// index.js in &apos;sagas&apos; folder</span><br><span class="line"></span><br><span class="line">import * as API from &apos;../api&apos;;</span><br><span class="line">import * as types from &apos;../redux/actionType&apos;;</span><br><span class="line">import &#123; call, put, fork, take, all &#125; from &apos;redux-saga/effects&apos;;</span><br><span class="line"></span><br><span class="line">function* fetchNews() &#123;</span><br><span class="line">  while (true) &#123;</span><br><span class="line">    yield take(types.GET_NEWS_REQUEST);</span><br><span class="line">    try &#123;</span><br><span class="line">      const res = yield call(API.getNews);</span><br><span class="line">      console.log(&apos;res&apos;, res)</span><br><span class="line">      if (res.status === 200) &#123;</span><br><span class="line">        yield put(&#123;</span><br><span class="line">          type: types.GET_NEWS_SUCCESS,</span><br><span class="line">          payload: res.data</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        throw new Error();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">      yield put(&#123;</span><br><span class="line">        type: types.GET_NEWS_FAILURE</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default function* rootSaga() &#123;</span><br><span class="line">   yield all([</span><br><span class="line">     fork(fetchNews)</span><br><span class="line">   ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>effect란, 각각의 task를 기술하기 위한 명령어이다. 대표적인 effect는 다음과 같다.</p>
<ul>
<li>take: Action을 기다린다.</li>
<li>put: Action을 Dispatch 한다.</li>
<li>call: Promise의 완료를 기다린다.(서버 API와의 통신할 때 주로 사용)</li>
<li>fork: 다른 task를 시작한다.</li>
<li>join: 다른 task의 종료를 기다린다.</li>
<li>select: state로부터 필요한 데이터를 꺼낸다.</li>
</ul>
<p><br></p>
<h2 id="8-saga-이후-state를-변경할-reducer-작성"><a href="#8-saga-이후-state를-변경할-reducer-작성" class="headerlink" title="8. saga 이후, state를 변경할 reducer 작성"></a>8. saga 이후, state를 변경할 reducer 작성</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">// reducer.js</span><br><span class="line"></span><br><span class="line">import &#123; combineReducers &#125; from &quot;redux&quot;;</span><br><span class="line">import * as types from &quot;./actionType&quot;;</span><br><span class="line"></span><br><span class="line">const initialGetNews = &#123; payload: &#123; articles: [] &#125;, loading: false &#125;</span><br><span class="line"></span><br><span class="line">const getNews = (state = initialGetNews, action) =&gt; &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">      case types.GET_NEWS_REQUEST:</span><br><span class="line">         return &#123;</span><br><span class="line">            ...state,</span><br><span class="line">            loading: true</span><br><span class="line">         &#125;;</span><br><span class="line">      case types.GET_NEWS_SUCCESS:</span><br><span class="line">      const &#123; articles &#125; = action.payload;</span><br><span class="line">      console.log(&apos;articles&apos;, articles)</span><br><span class="line">         return &#123;</span><br><span class="line">            ...state,</span><br><span class="line">            articles,</span><br><span class="line">            loading: false</span><br><span class="line">         &#125;;</span><br><span class="line">      case types.GET_NEWS_FAILURE:</span><br><span class="line">         return &#123;</span><br><span class="line">            ...state</span><br><span class="line">         &#125;</span><br><span class="line">      default:</span><br><span class="line">         return state;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const rootReducer = combineReducers(&#123;</span><br><span class="line">  getNews</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export default rootReducer;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h1 id="화면-재로딩-refresh-없이-post-요청한-데이터-같은-화면에-바로-가져오는-방법"><a href="#화면-재로딩-refresh-없이-post-요청한-데이터-같은-화면에-바로-가져오는-방법" class="headerlink" title="화면 재로딩(refresh) 없이, post 요청한 데이터 같은 화면에 바로 가져오는 방법"></a>화면 재로딩(refresh) 없이, post 요청한 데이터 같은 화면에 바로 가져오는 방법</h1><hr>
<p>만약, 화면에서 데이터를 서버에 보내고(post), 보낸 데이터와 관련된 데이터를 받아와야 하는 경우를 saga에서 처리할 수 있다.</p>
<p>예를 들어, ‘기부하기’ 버튼을 클릭해서, donation 액션을 dispatch 할때, payload로 기부자 이름과 메세지를 보낸다고 하자. 그리고, 아래 화면에는 기부자와 메세지를 보여준다고 해보자. 그럼 refresh 없이, ‘기부하기’ 버튼 클릭 후, 바로 화면에 데이터를 보여줄려면 어떻게 해야할까?</p>
<p>이것을 saga에서 처리하는 데,</p>
<ol>
<li>데이터를 서버에 보낸다.(yield call(API, payload))</li>
<li>성공하면(res.status === 200), 서버에서 데이터를 받아오는 API를 get 요청하여 받아온다.(yield call(getAPI))</li>
<li>성공하면(res.status === 200), 액션을 dispatch 하여, reducer에서 새로 받아온 데이터로 값을 변경하여, 화면에 데이터를 뿌려주게 된다.</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">function* addDonation() &#123;</span><br><span class="line">	while (true) &#123;</span><br><span class="line">        const request = yield take(types.ADD_DONATION_REQUEST);</span><br><span class="line"></span><br><span class="line">		try &#123;</span><br><span class="line">            const &#123; payload &#125; = request;</span><br><span class="line"></span><br><span class="line">            // 서버로 post 요청</span><br><span class="line">            const res = yield call(API.addDonation, payload);</span><br><span class="line"></span><br><span class="line">            if(res.status === 200 &amp;&amp; res.data.success)&#123;</span><br><span class="line">                yield put(&#123;</span><br><span class="line">                    type: types.ADD_DONATION_SUCCESS,</span><br><span class="line">                    payload:res.data</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                // 화면에 뿌려줄 데이터 서버로부터 가져오기</span><br><span class="line">                const result = yield call(API.getHistoryList,&#123;pageSize:10, pageNum:0&#125;)</span><br><span class="line">                if(result.status === 200)&#123;</span><br><span class="line"></span><br><span class="line">                  // 서버로부터 가져온 데이터를 화면에 뿌려주기 위한 액션을 disaptch 하기</span><br><span class="line">                    yield put(&#123;</span><br><span class="line">                        type: types.GET_HISTORY_LIST_SUCCESS,</span><br><span class="line">                        payload:result.data</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    console.log(&apos;throw res2&apos;)</span><br><span class="line">                    throw new Error();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;else if(res.data.success === false)&#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">		&#125; catch (e) &#123;</span><br><span class="line">			yield put(&#123;</span><br><span class="line">				type: types.ADD_DONATION_FAILURE</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/React/">React</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redux-Saga/">Redux-Saga</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/04/24/url-share/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          URL 복사하기 버튼 만드는 방법
        
      </div>
    </a>
  
  
    <a href="/2019/04/20/combo-box/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Combo Box</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#순서"><span class="nav-number">1.</span> <span class="nav-text">순서</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-프로젝트-앱의-index-js에서-Redux와-연동"><span class="nav-number">1.1.</span> <span class="nav-text">1. 프로젝트 앱의 index.js에서 Redux와 연동</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-store-js에서-Redux의-store를-세팅"><span class="nav-number">1.2.</span> <span class="nav-text">2. store.js에서 Redux의 store를 세팅</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Redux와-연결할-Container-컴포넌트와-화면에-보여줄-각-컴포넌트-생성"><span class="nav-number">1.3.</span> <span class="nav-text">3. Redux와 연결할 Container 컴포넌트와 화면에 보여줄 각 컴포넌트 생성</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-통신할-API와-관련된-코드-작성"><span class="nav-number">1.4.</span> <span class="nav-text">4. 통신할 API와 관련된 코드 작성</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-action-및-action-types-등록"><span class="nav-number">1.5.</span> <span class="nav-text">5. action 및 action types 등록</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Container-컴포넌트에서-액션을-dispatch-state-및-dispatch-코드-작성"><span class="nav-number">1.6.</span> <span class="nav-text">6. Container 컴포넌트에서 액션을 dispatch(state 및 dispatch 코드 작성)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-액션을-받아-비동기-통신-처리를-할-saga-작성"><span class="nav-number">1.7.</span> <span class="nav-text">7. 액션을 받아 비동기 통신 처리를 할 saga 작성</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-saga-이후-state를-변경할-reducer-작성"><span class="nav-number">1.8.</span> <span class="nav-text">8. saga 이후, state를 변경할 reducer 작성</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#화면-재로딩-refresh-없이-post-요청한-데이터-같은-화면에-바로-가져오는-방법"><span class="nav-number">2.</span> <span class="nav-text">화면 재로딩(refresh) 없이, post 요청한 데이터 같은 화면에 바로 가져오는 방법</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/about" class="mobile-nav-link">Me &amp; Projects</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 Hexo All Rights Reserved.
        
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-125478847-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->






  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
